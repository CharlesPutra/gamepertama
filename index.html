<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game pertama charles</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <h1>Plane Space</h1>
    <h3>Score : <span id="score">0</span></h3>
    <div id="main" style="background-position-y: 0;">
        <div id="area">
            <div id="plane" style="margin-left: 130px; margin-top: 400px;"></div>
            <div id="meteor" style="margin-top: 600px;"></div>
        </div>
    </div>

    <script type="text/javascript">

        var isMoving = true;

        function setBackgroundMoving() {
            if(isMoving == true) {
            setTimeout(function(){
                //setting background berjalan
                var bg = document.getElementById('main');
                bg.style.backgroundPositionY = (parseInt(bg.style.backgroundPositionY.replace('px','')) + 1) + 'px';

                //update score
                document.getElementById('score').innerHTML = parseInt(document.getElementById('score').innerHTML) + 1;

                //paggil recursive set background moving
                setBackgroundMoving();
            },5);
        }
        }
        //inisialisasi background  berjalannya
        setBackgroundMoving();



        //setting meteor berjalan
        function setMeteorMoving() {
            var meteor = document.getElementById('meteor');
           var plane = document.getElementById('plane');

            setTimeout(function() {
                meteor.style.marginTop = (parseInt(meteor.style.marginTop.replace('px','')) + 1) + 'px';
                if(parseInt(meteor.style.marginTop.replace('px','')) > 500) {
                    meteor.style.marginLeft = (Math.floor(Math.random() * 250) + 50) + 'px';
                    meteor.style.marginTop = "-100px";
                }

                if(meteor.offsetTop + 56 >= plane.offsetTop && meteor.offsetLeft + 50 >= plane.offsetLeft && meteor.offsetTop + 56 <= plane.offsetTop + 100 && meteor.offsetLeft <= plane.offsetLeft + 50) {
                    alert('Game Over, Score Anda :' + document.getElementById('score').innerHTML);
                    isMoving = false;
                    
                }else {
                    //panggil gerakan meteor
                    setMeteorMoving();
                }

            }, 1);
        }
        //inisialisasi meteor
        setMeteorMoving();

        //setting berjalannya plane
        window.addEventListener('keydown', function(e) {
            var plane = document.getElementById('plane');
            atas = parseInt(plane.style.marginTop.replace('px',''));
            left = parseInt(plane.style.marginLeft.replace('px',''));
            // keycode plane Bawah = 40 ,atas = 38 ,kiri = 37 ,kanan = 39

            
            //validasi jalan plane
            if(isMoving == true){
            if(e.keyCode == 37) {
                if(left > 0) {
                    plane.style.marginLeft = (left - 10) + 'px';
                }
            }else if(e.keyCode == 38) {
                if(atas > 0) {
                    plane.style.marginTop = (atas - 10) + 'px';
                }
            }else if(e.keyCode == 39) {
                if(left < 340) {
                    plane.style.marginLeft = (left + 10) + 'px';
                }
            }else if(e.keyCode == 40) {
                if(atas < 440) {
                    plane.style.marginTop = (atas + 10) + 'px';
                }
            }
        }

        });
    </script>
</body>
</html>